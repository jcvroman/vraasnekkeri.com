# Continuous Delivery (CD):
#   Generate release notes from the changelog.
name: cd-generate-releasenotes

# Controls when the workflow will run
on:
  # Allows you to run this workflow manually from the Actions tab.
  workflow_dispatch:

# Jobs.
jobs:
  generate-releasenotes:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

#      - name: Extract release notes
#        id: releasenotes
#        uses: ffurrer2/extract-release-notes@v1
#        with:
#          changelog_file: ./CHANGELOG.md

      - name: Generate Changelog
        uses: scottbrenner/generate-changelog-action@master
        id: changelog
        with:
          from-tag: v1.0
          to-tag: HEAD

      # Overwrite as writing new release notes.
      - name: Write to RELEASE_NOTES.md
        uses: DamianReeves/write-file-action@master
        with:
          path: ./RELEASE_NOTES.md
          contents: ${{ steps.changelog.outputs.changelog }}
          write-mode: overwrite

      - name: Commit and push RELEASE.md
        uses: EndBug/add-and-commit@v7
        with:
          add: RELEASE_NOTES.md
          message: "chore: Update RELEASE_NOTES.md"
